# Requirements Archive: v1.4 Observability

**Archived:** 2026-01-24
**Status:** ✅ SHIPPED

This is the archived requirements specification for v1.4.
For current requirements, see `.planning/REQUIREMENTS.md` (created for next milestone).

---

# Requirements: wanctl v1.4

**Defined:** 2026-01-23
**Core Value:** Sub-second congestion detection with 50ms control loops

## v1.4 Requirements

Requirements for steering daemon observability. Each maps to roadmap phases.

### Health Endpoint

- [x] **HLTH-01**: Steering daemon exposes HTTP health endpoint on port 9102
- [x] **HLTH-02**: Health endpoint responds to GET / and GET /health
- [x] **HLTH-03**: Response is JSON with status, uptime_seconds, version fields
- [x] **HLTH-04**: Returns 200 OK when healthy, 503 Service Unavailable when degraded
- [x] **HLTH-05**: Health server runs in background thread (daemon=True)
- [x] **HLTH-06**: Health server supports clean shutdown

### Steering State

- [x] **STEER-01**: Health response includes current steering state (enabled/disabled)
- [x] **STEER-02**: Health response includes confidence scores from ConfidenceController
- [x] **STEER-03**: Health response includes primary WAN congestion state
- [x] **STEER-04**: Health response includes secondary WAN congestion state (N/A - documented)
- [x] **STEER-05**: Health response includes last decision timestamp

### Integration

- [x] **INTG-01**: Health server starts during steering daemon initialization
- [x] **INTG-02**: Health server stops during steering daemon shutdown
- [x] **INTG-03**: Health status updates reflect current daemon state

## Future Requirements

Deferred to future release. Tracked but not in current roadmap.

### Metrics History

- **METR-01**: Rolling window of recent measurements
- **METR-02**: Historical steering decisions log
- **METR-03**: Prometheus-compatible /metrics endpoint

## Out of Scope

Explicitly excluded. Documented to prevent scope creep.

| Feature | Reason |
|---------|--------|
| Prometheus integration | Keep self-contained, no external dependencies |
| WebSocket streaming | Complexity, polling sufficient |
| Authentication | Internal network only, localhost binding |
| Config reload via API | Config is file-based, restart to reload |

## Traceability

Which phases cover which requirements. Updated during roadmap creation.

| Requirement | Phase | Status |
|-------------|-------|--------|
| HLTH-01 | 25 | ✓ Complete |
| HLTH-02 | 25 | ✓ Complete |
| HLTH-03 | 25 | ✓ Complete |
| HLTH-04 | 25 | ✓ Complete |
| HLTH-05 | 25 | ✓ Complete |
| HLTH-06 | 25 | ✓ Complete |
| STEER-01 | 26 | ✓ Complete |
| STEER-02 | 26 | ✓ Complete |
| STEER-03 | 26 | ✓ Complete |
| STEER-04 | 26 | ✓ Complete (N/A) |
| STEER-05 | 26 | ✓ Complete |
| INTG-01 | 26 | ✓ Complete |
| INTG-02 | 26 | ✓ Complete |
| INTG-03 | 26 | ✓ Complete |

**Coverage:**
- v1.4 requirements: 14 total
- Shipped: 14
- Unmapped: 0

---

## Milestone Summary

**Shipped:** 14 of 14 v1.4 requirements
**Adjusted:** None
**Dropped:** None

---
*Archived: 2026-01-24 as part of v1.4 milestone completion*
