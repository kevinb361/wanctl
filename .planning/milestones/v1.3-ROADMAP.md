# Milestone v1.3: Reliability & Hardening

**Status:** SHIPPED 2026-01-21
**Phases:** 21-24
**Total Plans:** 5

## Overview

Close test coverage gaps identified in CONCERNS.md analysis and improve deployment safety. This milestone focused on proving safety invariants through tests and wiring implemented features into production code paths.

## Phases

### Phase 21: Critical Safety Tests

**Goal**: Core control algorithms have tests verifying safety invariants
**Depends on**: Nothing (first v1.3 phase)
**Requirements**: TEST-01, TEST-02, TEST-03
**Plans**: 2 plans

Plans:

- [x] 21-01-PLAN.md - Baseline freeze + state corruption tests (TEST-01, TEST-02)
- [x] 21-02-PLAN.md - Transport failover implementation + tests (TEST-03)

**Phase 21 Complete:** +46 tests (671 to 717), safety invariants proven for baseline freeze, state corruption recovery, and REST-to-SSH failover.

### Phase 22: Deployment Safety

**Goal**: Deployment is safer with consistent naming and validation
**Depends on**: Phase 21
**Requirements**: DEPLOY-01, DEPLOY-02, DEPLOY-03
**Plans**: 1 plan

Plans:

- [x] 22-01-PLAN.md - Config cleanup, deploy script hardening, validation script (DEPLOY-01, DEPLOY-02, DEPLOY-03)

**Phase 22 Complete:** Legacy config removed, deploy script hardened with fail-fast, validation script created (423 lines).

### Phase 23: Edge Case Tests

**Goal**: Boundary conditions have explicit test coverage
**Depends on**: Phase 22
**Requirements**: TEST-04, TEST-05
**Plans**: 1 plan

Plans:

- [x] 23-01-PLAN.md - Rate limiter rapid restart tests + dual fallback failure tests (TEST-04, TEST-05)

**Phase 23 Complete:** +56 tests (671 to 727), edge cases proven for rate limiter restart behavior and dual fallback failure safety.

### Phase 24: Wire Integration Gaps

**Goal**: Implemented safety features are active in production code paths
**Depends on**: Phase 23
**Gap Closure**: Closes integration gaps from v1.3-MILESTONE-AUDIT.md
**Plans**: 1 plan

Plans:

- [x] 24-01-PLAN.md - Wire FailoverRouterClient and validation script to production

**Phase 24 Complete:** FailoverRouterClient wired into all 3 production entry points, validate-deployment.sh integrated into deploy.sh workflow.

---

## Milestone Summary

**Key Decisions:**

- Baseline freeze tests use 100+ cycles to prove sustained load invariant
- Corruption tests cover 12 distinct failure modes for comprehensive coverage
- Failover is sticky: once triggered, stays on fallback until close()
- Lazy client creation: fallback only instantiated on first failure
- steering.yaml is canonical config name (legacy steering_config_v2.yaml removed)
- Deploy script fails-fast on missing steering.yaml (no silent fallback)
- Restart isolation documented as design characteristic (new RateLimiter = fresh quota)

**Issues Resolved:**

- REST API failures no longer crash daemon (automatic SSH fallback)
- State file corruption no longer crashes on startup (graceful recovery)
- Deployment validates config/connectivity before daemon start
- Legacy config naming inconsistency eliminated

**Issues Deferred:**

- Phase2BController production enablement (currently dry-run, requires continued validation)

**Technical Debt Incurred:**

None.

---

*For current project status, see .planning/ROADMAP.md*
