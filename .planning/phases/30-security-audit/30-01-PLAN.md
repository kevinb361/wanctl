---
phase: 30-security-audit
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - pyproject.toml
  - .secrets.baseline
autonomous: true

must_haves:
  truths:
    - "Security tools are installable via uv sync"
    - "Bandit configuration exists in pyproject.toml"
    - "Secrets baseline file exists for detect-secrets"
  artifacts:
    - path: "pyproject.toml"
      provides: "Security tool dev dependencies"
      contains: "pip-audit"
    - path: "pyproject.toml"
      provides: "Bandit configuration"
      contains: "[tool.bandit]"
    - path: ".secrets.baseline"
      provides: "Secrets detection baseline"
      contains: "plugins_used"
  key_links:
    - from: "pyproject.toml"
      to: ".venv/bin/pip-audit"
      via: "uv sync"
      pattern: "pip-audit"
---

<objective>
Install and configure Python security scanning tools for dependency vulnerabilities, static analysis, secret detection, and license compliance.

Purpose: Establish the tooling foundation for ongoing security scanning. Without tools installed and configured, scans cannot run.
Output: Updated pyproject.toml with security tools in dev deps, bandit config section, and .secrets.baseline file.
</objective>

<execution_context>
@/home/kevin/.claude/get-shit-done/workflows/execute-plan.md
@/home/kevin/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/30-security-audit/30-CONTEXT.md
@.planning/phases/30-security-audit/30-RESEARCH.md
@pyproject.toml
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add security tools to dev dependencies</name>
  <files>pyproject.toml</files>
  <action>
Add security scanning tools to the [dependency-groups] dev section:
- pip-audit>=2.10.0 (dependency vulnerability scanning)
- bandit>=1.9.3 (static security analysis)
- detect-secrets>=1.5.0 (secret detection)
- pip-licenses>=5.5.0 (license compliance)

Then run `uv sync` to install the new dependencies.

Do NOT add safety (requires API key). Use pip-audit which is PyPA official.
  </action>
  <verify>
Run `.venv/bin/pip-audit --version && .venv/bin/bandit --version && .venv/bin/detect-secrets --version && .venv/bin/pip-licenses --version` - all should return version info
  </verify>
  <done>All four security tools are installed and executable from .venv/bin/</done>
</task>

<task type="auto">
  <name>Task 2: Configure bandit and create secrets baseline</name>
  <files>pyproject.toml, .secrets.baseline</files>
  <action>
Add [tool.bandit] section to pyproject.toml:
```toml
[tool.bandit]
exclude_dirs = [".venv", "build", "dist"]
# Note: tests/ not excluded - CONTEXT.md requires all findings block
# B101 (assert_used) may need inline nosec in tests if it triggers
```

Create .secrets.baseline by running:
```bash
.venv/bin/detect-secrets scan > .secrets.baseline
```

If the baseline shows any findings, audit them:
- False positives: Mark as audited in baseline or add `# pragma: allowlist secret`
- Real secrets: Remove from codebase (should not exist per project design)

Do NOT add .secrets.baseline to .gitignore - it should be committed.
  </action>
  <verify>
1. `grep -q "\[tool.bandit\]" pyproject.toml` returns 0
2. `test -f .secrets.baseline` returns 0
3. `.venv/bin/detect-secrets scan --baseline .secrets.baseline` exits 0
  </verify>
  <done>Bandit config in pyproject.toml, .secrets.baseline exists and validates</done>
</task>

</tasks>

<verification>
```bash
# All tools installed
.venv/bin/pip-audit --version
.venv/bin/bandit --version
.venv/bin/detect-secrets --version
.venv/bin/pip-licenses --version

# Configuration exists
grep -q "\[tool.bandit\]" pyproject.toml && echo "bandit config: OK"
test -f .secrets.baseline && echo "secrets baseline: OK"
```
</verification>

<success_criteria>
- All four security tools executable from .venv/bin/
- [tool.bandit] section exists in pyproject.toml
- .secrets.baseline file exists and validates against current codebase
</success_criteria>

<output>
After completion, create `.planning/phases/30-security-audit/30-01-SUMMARY.md`
</output>
