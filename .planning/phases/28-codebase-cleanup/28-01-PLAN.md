---
phase: 28-codebase-cleanup
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - tests/test_baseline_rtt_manager.py
  - .planning/phases/28-codebase-cleanup/28-CLEANUP-REPORT.md
autonomous: true

must_haves:
  truths:
    - "All ruff checks pass with no errors"
    - "Complexity analysis documented with function-by-function breakdown"
    - "Dead code analysis confirms codebase is clean"
    - "TODO inventory confirms no markers exist"
  artifacts:
    - path: ".planning/phases/28-codebase-cleanup/28-CLEANUP-REPORT.md"
      provides: "Comprehensive cleanup analysis report"
      contains: "Complexity Analysis"
  key_links: []
---

<objective>
Perform codebase cleanup analysis and apply minor style fixes.

Purpose: Document code health, apply automated fixes, and create actionable cleanup report for future work.
Output: Clean ruff output, complexity analysis report, TODO inventory (empty), pattern consistency notes.
</objective>

<execution_context>
@/home/kevin/.claude/get-shit-done/workflows/execute-plan.md
@/home/kevin/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/28-codebase-cleanup/28-CONTEXT.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Apply ruff fixes and verify clean check</name>
  <files>tests/test_baseline_rtt_manager.py</files>
  <action>
    Run `ruff check --fix --unsafe-fixes src/wanctl/ tests/` to fix the one B007 issue (unused loop variable `cycle` -> `_cycle`).

    Then verify with `ruff check src/wanctl/ tests/` to confirm all checks pass.

    Do NOT change anything else. The fix is:
    - File: tests/test_baseline_rtt_manager.py line 341
    - Change: `for cycle in range(100):` -> `for _cycle in range(100):`
  </action>
  <verify>`ruff check src/wanctl/ tests/` returns "All checks passed!" with exit code 0</verify>
  <done>All ruff checks pass, B007 issue resolved</done>
</task>

<task type="auto">
  <name>Task 2: Create comprehensive cleanup report</name>
  <files>.planning/phases/28-codebase-cleanup/28-CLEANUP-REPORT.md</files>
  <action>
    Create cleanup analysis report with these sections:

    **1. Dead Code Analysis**
    - Run `ruff check --select F401,F841,F811 src/wanctl/ tests/` to check unused imports/variables
    - Document that no dead code was found
    - Note the conservative approach from CONTEXT.md was followed

    **2. TODO/FIXME Inventory**
    - Search for TODO, FIXME, HACK, XXX, NOTE markers in src/ and tests/
    - Document that no markers were found (codebase is clean)
    - Cross-reference with .planning/todos/pending/ for tracked items

    **3. Complexity Analysis**
    - Run `ruff check --select C901 src/wanctl/` and document all 11 high-complexity functions
    - For each function: file, line, complexity score, brief description
    - Note which are core algorithms (protected per CLAUDE.md) vs candidates for refactoring
    - Create prioritized list: which functions COULD be refactored vs which SHOULD NOT be touched

    **4. Style Consistency**
    - Document the one B007 fix applied
    - Note that full ruff lint suite passes
    - Document pyproject.toml ruff configuration (line-length, selected rules)

    **5. Recommendations**
    - High-complexity functions that could be split (if any safe candidates)
    - Note: most complexity is in `main()` entry points and core algorithms - refactoring not recommended

    Format as markdown with clear sections and tables where appropriate.
  </action>
  <verify>File exists at `.planning/phases/28-codebase-cleanup/28-CLEANUP-REPORT.md` with all 5 sections</verify>
  <done>Comprehensive cleanup report documents code health status</done>
</task>

</tasks>

<verification>
1. `ruff check src/wanctl/ tests/` exits with code 0
2. `grep -r "TODO\|FIXME\|HACK\|XXX" src/ tests/` returns no matches
3. 28-CLEANUP-REPORT.md contains all 5 sections with accurate data
</verification>

<success_criteria>
- All ruff checks pass (0 errors)
- Cleanup report exists with complexity analysis of 11 functions
- TODO inventory confirms codebase has no markers
- Report documents which high-complexity functions are protected core algorithms
</success_criteria>

<output>
After completion, create `.planning/phases/28-codebase-cleanup/28-01-SUMMARY.md`
</output>
