---
phase: 29-documentation-verification
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - docs/CONFIG_SCHEMA.md
  - docs/CONFIGURATION.md
autonomous: true

must_haves:
  truths:
    - "CONFIG_SCHEMA.md documents all validated config fields"
    - "Default values in docs match actual code defaults"
    - "Validation bounds (min/max) match config_validation_utils.py"
    - "No undocumented required fields"
  artifacts:
    - path: "docs/CONFIG_SCHEMA.md"
      provides: "Full config schema reference"
    - path: "docs/CONFIGURATION.md"
      provides: "Config quick reference"
  key_links:
    - from: "docs/CONFIG_SCHEMA.md"
      to: "src/wanctl/config_validation_utils.py"
      via: "validation bounds"
      pattern: "MIN_SANE_BASELINE_RTT|MAX_SANE_BASELINE_RTT"
    - from: "docs/CONFIGURATION.md"
      to: "src/wanctl/config_base.py"
      via: "default values"
      pattern: "CURRENT_SCHEMA_VERSION"
---

<objective>
Verify config documentation accuracy against actual validation code.

Purpose: Config docs are high-value - users rely on them for deployment. Inaccurate bounds/defaults cause hard-to-debug issues.
Output: CONFIG_SCHEMA.md and CONFIGURATION.md verified against code, discrepancies fixed.
</objective>

<execution_context>
@/home/kevin/.claude/get-shit-done/workflows/execute-plan.md
@/home/kevin/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/29-documentation-verification/29-CONTEXT.md
@.planning/phases/29-documentation-verification/29-RESEARCH.md

# Config validation source of truth
@src/wanctl/config_base.py
@src/wanctl/config_validation_utils.py
</context>

<tasks>

<task type="auto">
  <name>Task 1: Cross-reference CONFIG_SCHEMA.md with validation code</name>
  <files>
    - docs/CONFIG_SCHEMA.md
    - src/wanctl/config_validation_utils.py
    - src/wanctl/config_base.py
  </files>
  <action>
Read CONFIG_SCHEMA.md and extract all documented:
1. Field names and their types
2. Default values claimed
3. Validation bounds (min/max, allowed values)
4. Required vs optional status

Cross-reference each against the code:

**In config_validation_utils.py, verify:**
- MIN_SANE_BASELINE_RTT / MAX_SANE_BASELINE_RTT values
- validate_bandwidth_order() logic
- validate_threshold_order() logic
- validate_alpha() bounds
- validate_baseline_rtt() bounds
- Any other validate_* functions

**In config_base.py, verify:**
- CURRENT_SCHEMA_VERSION value
- Required field patterns
- ConfigValidationError usage

For each discrepancy found:
1. Note the doc claim vs code reality
2. Determine which is correct (code is authoritative)
3. Mark for fix in Task 2

Also check for:
- Undocumented fields (in code but not in doc)
- Documented but removed fields (in doc but not in code)
- Deprecated field handling (floor_mbps legacy)
  </action>
  <verify>
Extract code values and compare to doc claims:
1. `grep -n "MIN_SANE_BASELINE_RTT\|MAX_SANE_BASELINE_RTT" /home/kevin/projects/wanctl/src/wanctl/config_validation_utils.py` - note actual values
2. `grep -n "baseline_rtt" /home/kevin/projects/wanctl/docs/CONFIG_SCHEMA.md` - verify doc matches code values
3. `grep -n "CURRENT_SCHEMA_VERSION" /home/kevin/projects/wanctl/src/wanctl/config_base.py` - note actual version
4. Compare schema version in CONFIG_SCHEMA.md header to code constant
  </verify>
  <done>Complete cross-reference list with discrepancies identified</done>
</task>

<task type="auto">
  <name>Task 2: Fix config documentation discrepancies</name>
  <files>
    - docs/CONFIG_SCHEMA.md
    - docs/CONFIGURATION.md
  </files>
  <action>
For each discrepancy found in Task 1:

1. **Fix inaccurate bounds** - Update doc to match code values
   Example: If doc says "baseline_rtt: 5-100ms" but code has MIN=10, MAX=60, fix doc

2. **Fix default values** - Match actual code defaults

3. **Add undocumented fields** - If code validates a field not in docs, add it

4. **Mark deprecated fields** - If field is still accepted but deprecated, add deprecation note

5. **Note duplicate content** - If CONFIG_SCHEMA.md and CONFIGURATION.md overlap significantly:
   - Keep CONFIG_SCHEMA.md as authoritative full reference
   - Keep CONFIGURATION.md as quick-start guide
   - Ensure they don't contradict each other
   - If CONFIGURATION.md adds no value, note in AUDIT-REPORT.md (don't delete without user decision)

6. **Check example YAML snippets** - If docs include example config, verify against actual config loader

Commit each file separately per CONTEXT.md commit strategy.
  </action>
  <verify>
1. Re-read CONFIG_SCHEMA.md and trace each claim to code
2. `grep -n "MIN_SANE\|MAX_SANE" src/wanctl/config_validation_utils.py` values match doc
3. No contradictions between CONFIG_SCHEMA.md and CONFIGURATION.md
  </verify>
  <done>Config docs match actual validation behavior, no factual errors remain</done>
</task>

</tasks>

<verification>
1. Every bound/default in CONFIG_SCHEMA.md traceable to specific code line
2. CONFIGURATION.md does not contradict CONFIG_SCHEMA.md
3. All validate_* functions in config_validation_utils.py have corresponding doc coverage
4. Deprecated fields (floor_mbps) marked as deprecated in docs
</verification>

<success_criteria>
- CONFIG_SCHEMA.md bounds match code constants exactly
- Default values in docs match actual defaults
- No undocumented required fields
- CONFIGURATION.md and CONFIG_SCHEMA.md are consistent
- Deprecated field warnings present where appropriate
</success_criteria>

<output>
After completion, create `.planning/phases/29-documentation-verification/29-02-SUMMARY.md`
</output>
